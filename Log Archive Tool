#!/bin/bash

set -e

BACKUP_SRC="$HOME"                                             
BACKUP_DST="$HOME/storage/downloads"
TIMESTAMP=$(date +%Y%m%d_%H%M%S)                                
BACKUP_DIR="$BACKUP_DST/$TIMESTAMP"
BACKUP_FILENAME="backup_$TIMESTAMP.tar.gz"

if [ ! -d "$BACKUP_SRC" ]; then
  echo "Error: Source directory $BACKUP_SRC does not exist."
  exit 1
fi

mkdir -p "$BACKUP_DIR"

tar -czf "$BACKUP_DIR/$BACKUP_FILENAME" --exclude="$BACKUP_DST" -C "$BACKUP_SRC" .

if [ $? -eq 0 ]; then
  echo "Backup was successful: $BACKUP_DIR/$BACKUP_FILENAME"
else
  echo "Backup failed"
  exit 1                                                       
fi
